# 北斗短报文解析模块

## 概述

本模块用于解析北斗短报文中的通信回执查询结果信息。根据北斗短报文通信协议，报文格式包括发信方 ID、收信方 ID、回执数、多个时间字段（年月日、时分秒）、以及其他通信信息。该模块可以将这些信息从原始的报文中提取出来并组织成易于使用的结构体。

## 主要功能

- **解析通信回执查询报文**：根据北斗通信协议，解析包括发信方、收信方、回执数、时间信息等内容。
- **时间字段处理**：支持解析多种时间格式，包括年月日和时分秒，能够处理多个时间段信息。
- **数据封装**：将解析后的数据封装在 `CommunicationReceiptMessage` 结构体中，方便后续使用。

## 报文格式

北斗通信回执查询结果信息的报文格式如下：

```
$BDRTI,x.x,x.x,x,xxxxxxxx,hhmmss,......,xxxxxxxx,hhmmss*hh<CR><LF>
```

### 语句格式说明

| 序号 | 名称                    | 取值范围        | 单位     | 说明                                   |
|------|-------------------------|-----------------|----------|----------------------------------------|
| 1    | 发信方 ID               | 1-16,777,215    | --       | 发起查询的用户地址                   |
| 2    | 收信方 ID               | 1-16,777,215    | --       | 原通信收方地址                       |
| 3    | 回执数                  | 0-7             | --       | 回执数 (0 表示无回执)                |
| 4    | 通信发信时间1（年月日） | 年月日          | --       | 示例：20210409                        |
| 5    | 通信发信时间2（时分秒） | 时分秒          | --       | 发信方入站时间                        |
| 6    | …                       | --              | --       | 其它通信时间字段（年月日、时分秒）  |
| 7    | 通信发信时间7（年月日） | 年月日          | --       | 最后一个通信时间字段                 |
| 8    | 通信发信时间7（时分秒） | 时分秒          | --       | 最后一个通信时间字段                 |

## 结构体定义

## `CommunicationReceiptMessage` 结构体

CommunicationReceiptMessage 代表解析后的通信回执查询结果信息。该结构体包含了发信方 ID、收信方 ID、回执数、通信发信时间以及其他通信时间信息。

```go
type CommunicationReceiptMessage struct {
 SenderID             uint64   `json:"sender_id"`             // 发信方 ID
 ReceiverID           uint64   `json:"receiver_id"`           // 收信方 ID
 ReceiptCount         int      `json:"receipt_count"`         // 回执数 (0-7)
 CommunicationTime1   string   `json:"comm_time_1"`           // 通信发信时间1（年月日）
 CommunicationTime2   string   `json:"comm_time_2"`           // 通信发信时间2（时分秒）
 AdditionalTimes      []string `json:"additional_times"`      // 其它的通信时间（年月日、时分秒）
}
```

## 依赖说明

此模块依赖于 Go 语言的标准库，特别是 strconv 和 strings 库用于字符串处理和类型转换。

## 错误处理

如果 Token 的数量不足以解析完整的报文，解析函数将返回错误。
如果某个 Token 无法被正确解析（例如，数字格式错误），解析函数也会返回错误。

## 扩展功能

此模块目前只解析了通信回执查询报文。未来可以扩展以支持更多类型的北斗短报文，例如应急搜救信息、位置报告信息等。

## 贡献

欢迎提交问题或贡献代码！如果您发现任何问题或有改进建议，请提交 issue 或发起 pull request。